# RiZoeL X - Telegram Projects
# (c) 2022 - 2023 RiZoeLX

import os, sys, asyncio, re
from random import choice
from .. import handler, Sudos, LOGS_CHANNEL
from pyrogram import Client, filters
from pyrogram.types import Message

from RiZoeLX.data import spam_usage
from RiZoeLX import res_grps, res_devs
from RiZoeLX.functions import start_spam, start_dspam, start_pspam


@Client.on_message(filters.user(Sudos) & filters.command(["delayspam"], prefixes=handler))
@Client.on_message(filters.me & filters.command(["delayspam"], prefixes=handler))
async def delayspam(SpamX: Client, e: Message): 
    usage = spam_usage.delayspam
    Rizoel = "".join(e.text.split(maxsplit=1)[1:]).split(" ", 2)
    Rizoelop = Rizoel[1:]
    if len(Rizoelop) == 2:
       counts = int(Rizoelop[0])
       spam_text = str(Rizoelop[1])
       sleeptime = float(Rizoel[0])
       await start_dspam(SpamX, e, counts, sleeptime, spam_text)
    else:
        await e.reply_text(usage.format(handler))
        return

    if LOGS_CHANNEL:
         try:
             await SpamX.send_message(LOGS_CHANNEL, f"started Delay Spam By User: {e.from_user.id} \n\n Chat: {e.chat.id} \n Counts: {counts} \n Spam Message: {msg} \n Delay Time: {sleeptime}")
         except Exception as a:
             print(a)
             pass


@Client.on_message(filters.user(Sudos) & filters.command(["pspam", "pornspam"], prefixes=handler))
@Client.on_message(filters.me & filters.command(["pspam", "pornspam"], prefixes=handler))
async def pornspam(SpamX: Client, e: Message):
    args = e.text.split(" ", 1)[1].split(" ", 1)
    if args:
       counts = int(args[0])
       await start_pspam(SpamX, e, counts)
       
       if LOGS_CHANNEL:
           try:
               await SpamX.send_message(LOGS_CHANNEL, f"started Porn Spam By User: {e.from_user.id} \n Chat: {e.chat.id} \n Counts: {count}")
           except Exception as a:
               print(a)
               pass
    else:
         await e.reply_text("Gime Counts")


@Client.on_message(filters.user(Sudos) & filters.command(["spam", "bigspam"], prefixes=handler))
@Client.on_message(filters.me & filters.command(["spam", "bigspam"], prefixes=handler))
async def justspam(SpamX: Client, e: Message):
    usage = spam_usage.spam
    Rizoel = "".join(e.text.split(maxsplit=1)[1:]).split(" ", 1)
    if len(Rizoel) == 2:
       counts = int(Rizoel[0])
       spam_text = str(Rizoel [1])
       await start_spam(SpamX, e, counts, spam_text)
    else:
        await e.reply_text(usage.format(handler))
        return 
    if LOGS_CHANNEL:
         try:
            await SpamX.send_message(LOGS_CHANNEL, f"started Spam By User: {e.from_user.id} \n\n Chat: {e.chat.id} \n Counts: {counts} \n Spam Message: {msg}")
         except Exception as a:
             print(a)
             pass

@Client.on_message(filters.user(Sudos) & filters.command(["hang"], prefixes=handler))
@Client.on_message(filters.me & filters.command(["hang"], prefixes=handler))
async def hang(SpamX: Client, e: Message): 
    counts = e.text[5:]
    if not counts:
        await e.reply_text("Gime Counts")
        return
    if int(e.chat.id) in res_grps:
        await e.reply_text("**Sorry !! i Can't Spam Here.**")
        return
    rizoel = "hangin...."
    count = int(counts)
    for _ in range(count):
         await SpamX.send_message(e.chat.id, rizoel)
         await asyncio.sleep(1)
    if LOGS_CHANNEL:
         try:
            await SpamX.send_message(LOGS_CHANNEL, f"started Hang Spam By User: {e.from_user.id} \n\n Chat: {e.chat.id} \n Counts: {count}")
         except Exception as a:
             print(a)
             pass
